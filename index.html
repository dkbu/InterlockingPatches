<!DOCTYPE html>
<html>
  <head>
    <script>
      document.addEventListener("DOMContentLoaded", function () {

          // Path to your CSS file, or empty "" if none:
          const CSS_FILE_PATH = "style.css"; 
          // Paths to your JS files, or empty [] if none:
          const JS_FILE_PATHS = ["pattern.js", "canvas.js", "export.js", "script.js"]; 
          function loadScript(src) {
            const script = document.createElement("script");
            script.src = src + "?nocache=" + new Date().getTime();
              script.async = true;
            document.head.appendChild(script);
          }
          function loadOptionalScript(src) {
            // Check if file exists before trying to load it
            fetch(src, { method: 'HEAD' })
              .then(response => {
                if (response.ok) {
                  loadScript(src);
                }
              })
              .catch(() => {
                // File doesn't exist, silently ignore
              }).finally(() => {
                for (const PATH of JS_FILE_PATHS) loadScript(PATH);
              });
          }
          function loadCSS(href) {
            const link = document.createElement("link");
            link.rel = "stylesheet";
            link.href = href + "?nocache=" + new Date().getTime();
            document.head.appendChild(link);
          }
          if (CSS_FILE_PATH) loadCSS(CSS_FILE_PATH);
          
          // Try to load optional localdev.js without generating warnings
          loadOptionalScript("localdev.js");

      });
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Designer</title>
    <!--<link id="favicon" rel="icon" type="image/x-icon" href="Icon.png"> -->
  </head>
  <body>
    <div id="container" class="container">
      <div id="sidebar" class="sidebar space_children">
        <details> <summary>Instructions</summary>
        <p><ul><li>To draw a stitch, click the starting point and then click the ending point.</li>
          <li>Ctrl+click when ending a stitch to start a new stitch there.</li>
          <li>To erase a stitch, click the starting and ending point again.</li>
          <li>Use right-click to place an ff point.</li>
          <li>To add rows or columns, click the gray area around the canvas.</li>
          <li>To remove rows or columns, right-click gray area around the canvas.</li></ul>
        </p>
        </details>
        <details> <summary>Tips</summary>
        <p><ul><li>Hold ctrl while placing a stitch to continue placing from that point.</li>
          <li>Ctrl+z will undo a stitch, and ctrl+y will re-do undone stitches.</li>
          <li>You can re-do stitches up until you place a new one.</li>
          <li>Reloading the page will reset the canvas - stitches and size!</li></ul>
        </p>
        </details>
        <details class="space_children"> <summary>Canvas Properties</summary>
          <input type="color" id="foregroundColor" name="foregroundColor" value="#000000" onchange="frame()">
          <label for="foregroundColor">Outline Color</label><br>

          <input type="color" id="backgroundColor" name="backgroundColor" value="#c1a485" onchange="frame()">
          <label for="backgroundColor">Fill Color</label><br>

          <input type="button" id="resetColors" value="Reset Colors" onclick="resetColors()"> <br>

          <input type="number" id="canvasXStitches" name="canvasXStitches" class="num_input" min="2" value="10" onchange="resizeCanvas()">
          <label for="canvasXStitches">Stitches across</label> <br>

          <input type="number" id="canvasYStitches" name="canvasYStitches" class="num_input" min="2" value="10" onchange="resizeCanvas()">
          <label for="canvasYStitches">Stitches down</label> <br>

          <input type="button" id="clearCanvas" value="Clear Canvas" onclick="clearCanvas()"> <br>

          <label for="save">Save to a file:</label>
          <input type="button" id="save" name="save" value="Save" onclick="saveCanvas()"> <br>

          <label for="load">Load from a file:</label>
          <input type="file" id="load" name="load" accept=".pattern">
          
        </details>
        <input type="button" id="exportBtn" value="Export to Text" style="display:none;" />
    
            <!-- ko-fi donation button -->
        <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Support the devs on Ko-fi', '#72a4f2', 'I2I51S7I62');kofiwidget2.draw();</script> 
      </div>
    <div class="canvas_div" oncontextmenu="return false;"> <!--this prevents context menu in the canvas, but also in the area to the right of it-->
        <canvas id="designerCanvas" width="20" height="50"></canvas>
    </div>
</div>
</body>
</html>